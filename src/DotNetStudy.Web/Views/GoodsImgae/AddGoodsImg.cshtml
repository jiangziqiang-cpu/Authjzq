
@{
    ViewData["Title"] = "AddGoods";
    Layout = "~/Views/Shared/_Layout1.cshtml";
}
@model DotNetStudy.Web.Models.GoodsImgae
@using System.IO


<script src="~/lib/jquery/dist/jquery.js"></script>
<script>
    $(function () {     
        //saveImgaeInfo();
        saveImgaeInfoSet();
    })
    function saveImgaeInfo() {
        var goodsid = $("#goodsId").val();
        $.ajax({
            url: "/GoodsImgae/saveGoodsImg",
            type: "POST",
            contentType: "application/json",
            data:JSON.stringify({ Id: 0, GoodsId: Number(goodsid), GoodsImgaeName: $("#goodsImgaeName").val(), Size: Number($("#size").val()) }),                                      
            dataType: "json",
            success: function (data) {
                //if (data != null) {
                alert($("#goodsId").val()+"-"+$("#size").val()+"-"+$("#goodsImgaeName").val());
                console.log($("#goodsId").val() + "-" + $("#size").val() + "-" + $("#goodsImgaeName").val());
                //}
            },
        })
    }
    function saveImgaeInfoSet() {
        $.ajax({
            url: "/GoodsImgae/save",
            type: "post",
            data: JSON.stringify({ "goodsId": $("#va").val(),  }),
            async: true,
            contentType: false,
            success: function (data) {
                //if (data != null) {
                alert($("#goodsId").val() + "-" + $("#size").val() + "-" + $("#goodsImgaeName").val());
                console.log($("#goodsId").val() + "-" + $("#size").val() + "-" + $("#goodsImgaeName").val());
                //}
            },
        })
    }

  
    function tst() {
        $.ajax({
            type: "POST",
            contentType: "application/json",
            url: "/GoodsImgae/Welcome",
            data: JSON.stringify({ "Id": 1, "GoodsImgaeName":$('#va').val()}),
            dataType: "json",
            success: function (data) {
                alert(data);
            }
        });
    };
</script>

@using (Html.BeginForm( "UploadFiles", "Home", FormMethod.Post,new { enctype = "multipart/form-data",id="form1"}))
{
    @Html.AntiForgeryToken()

<div class="form-horizontal">
    <h4>添加商品图片</h4>
    <hr />
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })   
    <div class="form-group">
        
        <div class="col-md-10">
            @Html.EditorFor(model => model.GoodsId, new { htmlAttributes = new { @class = "form-control", name = "GoodsId",id= "goodsId",type="hidden" } })
            @Html.ValidationMessageFor(model => model.GoodsId, "", new { @class = "text-danger" })
        </div>
    </div>
    <input  type="hidden"/>
    <div class="form-group">
        @Html.LabelFor(model => model.Size, htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.Size, new { htmlAttributes = new { @class = "form-control", name = "Size" , id="size", type = "hidden" } })
            @Html.ValidationMessageFor(model => model.Size, "", new { @class = "text-danger" })
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(model => model.GoodsImgaeName, htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">           
            @Html.EditorFor(model => model.GoodsImgaeName, new { htmlAttributes = new { @class = "form-control", name = "GoodsImgaeName", id= "goodsImgaeName", type = "hidden" } })
            @Html.ValidationMessageFor(model => model.GoodsImgaeName, "", new { @class = "text-danger" })
        </div>
    </div>
    <div class="form-group">               
        <div class="col-md-10">
            <label class="col-md-2">图片名称：</label>
            @{
                var v = ViewBag.type;
                if (v == 1)
                {

                    <img src="~/images/" name="ImgaeNameshow" />
                }
                else
                {
                    <img src="~/images/@Model.GoodsImgaeName" name="GoodsImgaeName" width="200" height="200" />

                }
            }
         
            @*<form action="/Home/UploadFiles" method="post" enctype="multipart/form-data" >*@
            <input type="file" name="files" multiple />
            <input type="submit" value="确定上传" />
        </div>
    </div>


    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input class="btn btn-default" type="button" value="确定添加" onclick="saveImgaeInfo()">                     
        </div>
    </div>
</div>
}

<form action="~/GoodsImgae/save" method="post">
    <input type="text" id="va" name="name" />
    <input class="btn btn-default" type="button" value="确定添加" onclick="saveImgaeInfoSet()">     
    <input type="submit" />
</form>
